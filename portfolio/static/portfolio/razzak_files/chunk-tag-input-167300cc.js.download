System.register(["./chunk-vendor.js"],(function(){"use strict";var t,e,i;return{setters:[function(s){t=s.o,e=s.h,i=s.f}],execute:function(){class TagInput{constructor(t){this.container=t.container,this.selections=t.selections,this.inputWrap=t.inputWrap,this.input=t.input,this.tagTemplate=t.tagTemplate,this.form=this.input.form,this.autoComplete=t.autoComplete,this.multiTagInput=t.multiTagInput}setup(){this.container.addEventListener("click",(t=>{t.target.closest(".js-remove")?this.removeTag(t):this.onFocus()})),this.input.addEventListener("focus",this.onFocus.bind(this)),this.input.addEventListener("blur",this.onBlur.bind(this)),this.input.addEventListener("keydown",this.onKeyDown.bind(this)),this.form.addEventListener("submit",this.onSubmit.bind(this)),this.autoComplete.addEventListener("auto-complete-change",(()=>{this.selectTag(this.autoComplete.value)}))}onFocus(){this.inputWrap.classList.add("focus"),this.input!==document.activeElement&&this.input.focus()}onBlur(){this.inputWrap.classList.remove("focus"),this.autoComplete.open||this.onSubmit()}onSubmit(){this.input.value&&(this.selectTag(this.input.value),this.autoComplete.open=!1)}onKeyDown(t){switch(e(t)){case"Backspace":this.onBackspace();break;case"Enter":case"Tab":this.taggifyValueWhenSuggesterHidden(t);break;case",":case" ":this.taggifyValue(t)}}taggifyValueWhenSuggesterHidden(t){!this.autoComplete.open&&this.input.value&&(t.preventDefault(),this.selectTag(this.input.value))}taggifyValue(t){this.input.value&&(t.preventDefault(),this.selectTag(this.input.value),this.autoComplete.open=!1)}selectTag(t){const e=this.normalizeTag(t),s=this.selectedTags();let n=!1;for(let i=0;i<e.length;i++){const t=e[i];s.indexOf(t)<0&&(this.selections.appendChild(this.templateTag(t)),n=!0)}n&&(this.input.value="",i(this.form,"tags:changed"))}removeTag(t){const e=t.target;t.preventDefault();e.closest(".js-tag-input-tag").remove(),i(this.form,"tags:changed")}templateTag(t){const e=this.tagTemplate.cloneNode(!0);e.querySelector("input").value=t;return e.querySelector(".js-placeholder-tag-name").replaceWith(t),e.classList.remove("d-none","js-template"),e}normalizeTag(t){const e=t.toLowerCase().trim();return e?this.multiTagInput?e.split(/[\s,']+/):[e.replace(/[\s,']+/g,"-")]:[]}onBackspace(){if(!this.input.value){const t=this.selections.querySelector("li:last-child .js-remove");t instanceof HTMLElement&&t.click()}}selectedTags(){const t=this.selections.querySelectorAll("input");return Array.from(t).map((t=>t.value)).filter((t=>t.length>0))}}t(".js-tag-input-container",{constructor:HTMLElement,initialize(t){new TagInput({container:t,inputWrap:t.querySelector(".js-tag-input-wrapper"),input:t.querySelector('input[type="text"], input:not([type])'),selections:t.querySelector(".js-tag-input-selected-tags"),tagTemplate:t.querySelector(".js-template"),autoComplete:t.querySelector("auto-complete"),multiTagInput:!1}).setup()}}),t(".js-multi-tag-input-container",{constructor:HTMLElement,initialize(t){new TagInput({container:t,inputWrap:t.querySelector(".js-tag-input-wrapper"),input:t.querySelector('input[type="text"], input:not([type])'),selections:t.querySelector(".js-tag-input-selected-tags"),tagTemplate:t.querySelector(".js-template"),autoComplete:t.querySelector("auto-complete"),multiTagInput:!0}).setup()}})}}}));
//# sourceMappingURL=chunk-tag-input-af7964c2.js.map
